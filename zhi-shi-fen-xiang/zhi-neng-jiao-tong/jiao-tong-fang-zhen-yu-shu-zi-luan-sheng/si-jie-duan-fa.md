# 四阶段法

微观的交通流与宏观的四阶段是传统交通行业的两大理论基础，而且分别有微观仿真软件如VISSIM与宏观仿真软件如TransCAD与之对应。其中，四阶段法虽然涉及大量的数学模型，但他的整体流程其实非常简单，只不过大量的教程都刻意复杂化了。用人话来说四阶段就是：

1. 阶段一“交通生成”：计算每个交通小区的到发量（PA值）。如何计算？工业界常用的就是吸引率法。规范中常常会给到每一类用地的高峰小时到发率，直接拿用地面积乘以这个比率，即可计算出PA值。
2. 阶段二“交通分布”：把PA转化为OD。上一步只是计算出每个小区的到发总量，但不知道这些到与发是从哪里来，到哪里去的。这一个阶段则是明确各个小区间的出行量。如何计算？最典型的就是重力模型。此外还有机会模型、增长率法等。
3. 阶段三“方式划分”：阶段二的OD是总的出行量，而这些出行量会由不同的交通方式来分担，比如一万的出行量中，有3000是小汽车，有3000是公交车，等等。我们流量预测往往是算小汽车，因此方式划分实际是从上一步的OD中抽取一部分出来。这一部分对应的理论以离散选择模型（Logit簇模型）为主，但实际工业界基本都是直接拍。
4. 阶段四“流量分配”：把从阶段三出来的流量往路网上分配，最终可以得到每条路的流量。如何分？基于阻抗函数构建最优化模型。阻抗函数可选择最短距离、最短时间，等等。最优化目标有用户最优，系统最优，等等。
